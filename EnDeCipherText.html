<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>En-De Cipher Text</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 2em;
      }
	    h1 {
    margin-bottom: 0.5em;
  }

  form {
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: #f2f2f2;
    padding: 2em;
    border-radius: 13px;
    box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.1);
  }

  label {
    margin-bottom: 0.5em;
    font-weight: bold;
	font-size: 20px;
	color: black;
  }

  input,
  textarea {
    padding: 0.5em;
    margin-bottom: 1em;
    border-radius: 5px;
    border: none;
    box-shadow: 0px 0px 5px 0px rgba(0, 0, 0, 0.1);
  }

  button {
    padding: 0.5em 1em;
    background-color: pink;
    color: #fff;
    border-radius: 0px;
    border: none;
    font-weight: bold;
    cursor: pointer;
  }

  .output {
    margin-top: 2em;
    background-color: #f2f2f2;
    padding: 2em;
    border-radius: 10px;
    box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.1);
	font-size: 20px;
	color: black;
	font-family: monospace;
  }

  .output h3 {
    margin-bottom: 0.5em;
    font-weight: bold;
  }
</style>
  </head>
  <body>
    <img style="text-align: center;" src="logoLock.png">
    <h1 style="font-size:100px; color:#f4c2c2; margin:10px; font-family: Times; " >En-De Cipher</h1>
    <b><h2 style="text-align: left; font-family: monospace">Welcome to En-De Cipher! Begin Encrypting and Decrypting Text using our free application!</h2></b>
    <h1><style type='text/css'>
      body{
        color: white;
        background-image:url('https://i.pinimg.com/originals/e8/ab/83/e8ab83923295950ea0456f39aed9f5f6.jpg');}
    </style></h1>
    <form>
      <label for="text">Text:</label>
      <textarea id="text" rows="10" cols="80"></textarea>
      <i><label for="password">KEY:</label></i><div style="color:black;font-size:10px;" class="divTableCell">(minimum length 16 characters!)</div>
      <input type="password" id="password" minlength="16">
      <button type="button" id="encryptBtn" onclick="encrypt()">Encrypt</button>
    </form>
    <div class="output">
     <center><h3>Encrypted Text:</h3></center>
     <textarea id="encrypted" rows="10" cols="80" readonly></textarea>
     <center><label for="password">Re-enter KEY to Decrypt:</label><div style="color:black;font-size:10px;" class="divTableCell">(minimum length 16 characters!)</div></center>
     <center><input type="password" id="password" minlength="16"></center>
     <center><button type="button" id="decryptBtn" onclick="decrypt()">Decrypt</button></center>
    </div>
    <div class="output">
     <center><h3>Decrypted Text:</h3></center>
      <textarea id="decrypted" rows="10" cols="80" readonly></textarea>
    </div>

<script>
const alphabet = "abcdefghijklmnopqrstuvwxyz";
const alphabetLength = alphabet.length;

const textInput = document.getElementById("text");
const passwordInput = document.getElementById("password");
const encryptBtn = document.getElementById("encryptBtn");
const decryptBtn = document.getElementById("decryptBtn");
const encryptedOutput = document.getElementById("encrypted");
const decryptedOutput = document.getElementById("decrypted");

let ciphertextBytes, iv;

async function encrypt() {
  const plaintext = textInput.value;
  const password = passwordInput.value;
  if (password.length < 16) {
    alert("Password should be at least 16 characters long!");
    return;
  }

  const plaintextBytes = new TextEncoder().encode(plaintext);
  const passwordBytes = new TextEncoder().encode(password);

  const key = await crypto.subtle.importKey("raw", passwordBytes, "PBKDF2", false, ["deriveKey"]);
  const derivedKey = await crypto.subtle.deriveKey({
    name: "PBKDF2",
    salt: passwordBytes,
    iterations: 100000,
    hash: "SHA-256"
  }, key, { name: "AES-GCM", length: 256 }, false, ["encrypt"]);

  iv = crypto.getRandomValues(new Uint8Array(12));

  const ciphertext = await crypto.subtle.encrypt({ name: "AES-GCM", iv: iv }, derivedKey, plaintextBytes);

  ciphertextBytes = new Uint8Array(ciphertext);
  const ciphertextHex = Array.from(ciphertextBytes).map(b => b.toString(16).padStart(2, "0")).join("");

  encryptedOutput.value = ciphertextHex;
}

async function decrypt() {
  const key = await crypto.subtle.importKey("raw", new TextEncoder().encode(passwordInput.value), "PBKDF2", false, ["deriveKey"]);
  const derivedKey = await crypto.subtle.deriveKey({
    name: "PBKDF2",
    salt: new TextEncoder().encode(passwordInput.value),
    iterations: 100000,
    hash: "SHA-256"
  }, key, { name: "AES-GCM", length: 256 }, false, ["decrypt"]);

  const decryptedBytes = await crypto.subtle.decrypt({ name: "AES-GCM", iv: iv }, derivedKey, ciphertextBytes);
  const decryptedPlaintext = new TextDecoder().decode(decryptedBytes);

  decryptedOutput.value = decryptedPlaintext;
}

encryptBtn.addEventListener("click", encrypt);
decryptBtn.addEventListener("click", decrypt);
</script>
  </body></html>

